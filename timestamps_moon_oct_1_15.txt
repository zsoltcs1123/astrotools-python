//@version=5
indicator("Moon Decans Oct 1-15", overlay = true)

decans = array.from(timestamp("2023-10-01 01:19:00"), timestamp("2023-10-01 18:12:00"), timestamp("2023-10-02 11:26:00"), timestamp("2023-10-03 05:04:00"), timestamp("2023-10-03 23:08:00"), timestamp("2023-10-04 17:37:00"), timestamp("2023-10-05 12:32:00"), timestamp("2023-10-06 07:51:00"), timestamp("2023-10-07 03:30:00"), timestamp("2023-10-07 23:25:00"), timestamp("2023-10-08 19:32:00"), timestamp("2023-10-09 15:46:00"), timestamp("2023-10-10 12:02:00"), timestamp("2023-10-11 08:16:00"), timestamp("2023-10-12 04:23:00"), timestamp("2023-10-13 00:22:00"), timestamp("2023-10-13 20:09:00"), timestamp("2023-10-14 15:44:00"), timestamp("2023-10-01 09:43:00"), timestamp("2023-10-02 02:46:00"), timestamp("2023-10-02 20:12:00"), timestamp("2023-10-03 14:03:00"), timestamp("2023-10-04 08:19:00"), timestamp("2023-10-05 03:02:00"), timestamp("2023-10-05 22:09:00"), timestamp("2023-10-06 17:38:00"), timestamp("2023-10-07 13:25:00"), timestamp("2023-10-08 09:27:00"), timestamp("2023-10-09 05:38:00"), timestamp("2023-10-10 01:54:00"), timestamp("2023-10-10 22:09:00"), timestamp("2023-10-11 18:20:00"), timestamp("2023-10-12 14:24:00"), timestamp("2023-10-13 10:17:00"), timestamp("2023-10-14 05:58:00"))
lines = array.from(Decan change at 2023-10-01 01:19:00: 4W -> 5P, Decan change at 2023-10-01 18:12:00: 5P -> 6P, Decan change at 2023-10-02 11:26:00: 6P -> 7P, Decan change at 2023-10-03 05:04:00: 7P -> 8S, Decan change at 2023-10-03 23:08:00: 8S -> 9S, Decan change at 2023-10-04 17:37:00: 9S -> 10S, Decan change at 2023-10-05 12:32:00: 10S -> 2C, Decan change at 2023-10-06 07:51:00: 2C -> 3C, Decan change at 2023-10-07 03:30:00: 3C -> 4C, Decan change at 2023-10-07 23:25:00: 4C -> 5W, Decan change at 2023-10-08 19:32:00: 5W -> 6W, Decan change at 2023-10-09 15:46:00: 6W -> 7W, Decan change at 2023-10-10 12:02:00: 7W -> 8P, Decan change at 2023-10-11 08:16:00: 8P -> 9P, Decan change at 2023-10-12 04:23:00: 9P -> 10P, Decan change at 2023-10-13 00:22:00: 10P -> 2S, Decan change at 2023-10-13 20:09:00: 2S -> 3S, Decan change at 2023-10-14 15:44:00: 3S -> 4S, Progression(position=MappedPosition(time=datetime.datetime(2023, 10, 1, 9, 43), planet='moon', lon=35.00644888352301, decan=Decan(id=4, name='5P', degree_range=DegreeRange(start=30, end=40)), term=Term(id=6, name='Venus', degree_range=DegreeRange(start=30, end=38))), name='50%'), Progression(position=MappedPosition(time=datetime.datetime(2023, 10, 2, 2, 46), planet='moon', lon=45.00614953215844, decan=Decan(id=5, name='6P', degree_range=DegreeRange(start=40, end=50)), term=Term(id=8, name='Jupiter', degree_range=DegreeRange(start=44, end=52))), name='50%'), Progression(position=MappedPosition(time=datetime.datetime(2023, 10, 2, 20, 12), planet='moon', lon=55.006498183938426, decan=Decan(id=6, name='7P', degree_range=DegreeRange(start=50, end=60)), term=Term(id=9, name='Saturn', degree_range=DegreeRange(start=52, end=57))), name='50%'), Progression(position=MappedPosition(time=datetime.datetime(2023, 10, 3, 14, 3), planet='moon', lon=65.0078523684194, decan=Decan(id=7, name='8S', degree_range=DegreeRange(start=60, end=70)), term=Term(id=11, name='Mercury', degree_range=DegreeRange(start=60, end=66))), name='50%'), Progression(position=MappedPosition(time=datetime.datetime(2023, 10, 4, 8, 19), planet='moon', lon=75.00114986063075, decan=Decan(id=8, name='9S', degree_range=DegreeRange(start=70, end=80)), term=Term(id=13, name='Venus', degree_range=DegreeRange(start=72, end=77))), name='50%'), Progression(position=MappedPosition(time=datetime.datetime(2023, 10, 5, 3, 2), planet='moon', lon=85.00549002162003, decan=Decan(id=9, name='10S', degree_range=DegreeRange(start=80, end=90)), term=Term(id=15, name='Saturn', degree_range=DegreeRange(start=84, end=90))), name='50%'), Progression(position=MappedPosition(time=datetime.datetime(2023, 10, 5, 22, 9), planet='moon', lon=95.00544260349814, decan=Decan(id=10, name='2C', degree_range=DegreeRange(start=90, end=100)), term=Term(id=16, name='Mars', degree_range=DegreeRange(start=90, end=97))), name='50%'), Progression(position=MappedPosition(time=datetime.datetime(2023, 10, 6, 17, 38), planet='moon', lon=105.00524504197722, decan=Decan(id=11, name='3C', degree_range=DegreeRange(start=100, end=110)), term=Term(id=18, name='Mercury', degree_range=DegreeRange(start=103, end=109))), name='50%'), Progression(position=MappedPosition(time=datetime.datetime(2023, 10, 7, 13, 25), planet='moon', lon=115.00086270007203, decan=Decan(id=12, name='4C', degree_range=DegreeRange(start=110, end=120)), term=Term(id=19, name='Jupiter', degree_range=DegreeRange(start=109, end=116))), name='50%'), Progression(position=MappedPosition(time=datetime.datetime(2023, 10, 8, 9, 27), planet='moon', lon=125.00335627768355, decan=Decan(id=13, name='5W', degree_range=DegreeRange(start=120, end=130)), term=Term(id=21, name='Jupiter', degree_range=DegreeRange(start=120, end=126))), name='50%'), Progression(position=MappedPosition(time=datetime.datetime(2023, 10, 9, 5, 38), planet='moon', lon=135.00259977960172, decan=Decan(id=14, name='6W', degree_range=DegreeRange(start=130, end=140)), term=Term(id=23, name='Saturn', degree_range=DegreeRange(start=131, end=138))), name='50%'), Progression(position=MappedPosition(time=datetime.datetime(2023, 10, 10, 1, 54), planet='moon', lon=145.00596063084913, decan=Decan(id=15, name='7W', degree_range=DegreeRange(start=140, end=150)), term=Term(id=25, name='Mars', degree_range=DegreeRange(start=144, end=150))), name='50%'), Progression(position=MappedPosition(time=datetime.datetime(2023, 10, 10, 22, 9), planet='moon', lon=155.0022467326756, decan=Decan(id=16, name='8P', degree_range=DegreeRange(start=150, end=160)), term=Term(id=26, name='Mercury', degree_range=DegreeRange(start=150, end=157))), name='50%'), Progression(position=MappedPosition(time=datetime.datetime(2023, 10, 11, 18, 20), planet='moon', lon=165.00059269453658, decan=Decan(id=17, name='9P', degree_range=DegreeRange(start=160, end=170)), term=Term(id=27, name='Venus', degree_range=DegreeRange(start=157, end=167))), name='50%'), Progression(position=MappedPosition(time=datetime.datetime(2023, 10, 12, 14, 24), planet='moon', lon=175.00446932801054, decan=Decan(id=18, name='10P', degree_range=DegreeRange(start=170, end=180)), term=Term(id=29, name='Mars', degree_range=DegreeRange(start=171, end=178))), name='50%'), Progression(position=MappedPosition(time=datetime.datetime(2023, 10, 13, 10, 17), planet='moon', lon=185.0026940986969, decan=Decan(id=19, name='2S', degree_range=DegreeRange(start=180, end=190)), term=Term(id=31, name='Saturn', degree_range=DegreeRange(start=180, end=186))), name='50%'), Progression(position=MappedPosition(time=datetime.datetime(2023, 10, 14, 5, 58), planet='moon', lon=195.0029912944043, decan=Decan(id=20, name='3S', degree_range=DegreeRange(start=190, end=200)), term=Term(id=33, name='Jupiter', degree_range=DegreeRange(start=191, end=198))), name='50%'))

for i = 0 to array.size(decans) - 1 
    if array.get(lines, i) == 100
        line.new(x1=array.get(decans, i), y1=low, x2=array.get(decans, i), y2=high, xloc=xloc.bar_time, extend=extend.both, color=color.new(#cfdef8, 10), style=line.style_solid, width=2)
    else if array.get(lines, i) == 50
        line.new(x1=array.get(decans, i), y1=low, x2=array.get(decans, i), y2=high, xloc=xloc.bar_time, extend=extend.both, color=color.new(#cfdef8, 30), style=line.style_dotted, width=1)